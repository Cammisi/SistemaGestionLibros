<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import java.net.URL?>

<BorderPane fx:id="rootPane" prefHeight="750.0" prefWidth="1100.0" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.libros.gestion_cliente.ui.controller.ReporteController">

    <stylesheets>
        <URL value="@../css/styles.css" />
    </stylesheets>

    <top>
        <HBox alignment="CENTER_LEFT" spacing="20.0" style="-fx-padding: 20; -fx-background-color: #333333;">
            <Label text="GestiÃ³n de Reportes y Cobranzas" styleClass="label-titulo"/>
            <Region HBox.hgrow="ALWAYS" />
            <Button text="Volver al MenÃº" onAction="#volverAlMenu" style="-fx-background-color: #555555;" prefWidth="150"/>
        </HBox>
    </top>

    <center>
        <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE" styleClass="tab-pane-grande">

            <Tab text="GestiÃ³n de Cobranzas">
                <VBox spacing="0">
                    <HBox spacing="15" style="-fx-padding: 30 30 20 30; -fx-alignment: CENTER_LEFT;">
                        <Label text="Buscar Cuotas por Cliente:" style="-fx-text-fill: white; -fx-font-size: 14px;"/>
                        <ComboBox fx:id="cmbClientesCobro" prefWidth="250" promptText="Seleccione Cliente..."/>
                        <Button text="ðŸ” Buscar" onAction="#buscarCuotas" styleClass="boton-azul"/>

                        <Region HBox.hgrow="ALWAYS"/>

                        <Button text="ðŸ“„ Generar Recibo PDF" onAction="#generarReciboPdf" styleClass="boton-verde"/>
                    </HBox>

                    <TableView fx:id="tablaCuotas" VBox.vgrow="ALWAYS" style="-fx-padding: 0 0 10 0;">
                        <columns>
                            <TableColumn fx:id="colCuotaVenta" text="Nro Factura" prefWidth="120" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colCuotaNumero" text="Cuota NÂ°" prefWidth="80" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colCuotaVencimiento" text="Vencimiento" prefWidth="120" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colCuotaMonto" text="Monto ($)" prefWidth="120" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colCuotaEstado" text="Estado" prefWidth="120" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colCuotaAccion" text="AcciÃ³n" prefWidth="140" style="-fx-alignment: CENTER;"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>

            <Tab text="Hoja de Ruta (Visitas)">
                <VBox spacing="0">
                    <HBox spacing="15" style="-fx-padding: 30 30 20 30; -fx-alignment: CENTER_LEFT;">
                        <Label text="Clientes Libres de Deuda (Para Visitar)" style="-fx-text-fill: #ffd700; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="ðŸ”„ Actualizar Lista" onAction="#cargarClientesLibres"/>
                        <Button text="ðŸ“Š Exportar Excel (CSV)" onAction="#exportarCsvVisitas" style="-fx-background-color: #27ae60; -fx-text-fill: white;"/>
                    </HBox>

                    <TableView fx:id="tablaVisitas" VBox.vgrow="ALWAYS" style="-fx-padding:  0 0 10 0;">
                        <columns>
                            <TableColumn fx:id="colVisitaLocalidad" text="Localidad" prefWidth="150" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colVisitaCliente" text="Cliente" prefWidth="200" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colVisitaTelefono" text="TelÃ©fono" prefWidth="120" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colVisitaIntereses" text="Intereses" prefWidth="200" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colVisitaHistorial" text="Historial Compras" prefWidth="250" style="-fx-alignment: CENTER;"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>

            <Tab text="BÃºsqueda por Intereses">
                <VBox spacing="0">
                    <HBox spacing="15" style="-fx-padding: 30 30 20 30; -fx-alignment: CENTER_LEFT;">
                        <Label text="Tema o Libro:" style="-fx-text-fill: white; -fx-font-size: 14px;"/>
                        <TextField fx:id="txtTema" promptText="Ej: Cocina, Historia, Harry Potter..." prefWidth="300"/>
                        <Button text="ðŸŽ¯ Buscar Interesados" onAction="#buscarPorTema" styleClass="boton-azul"/>
                    </HBox>

                    <TableView fx:id="tablaInteresados" VBox.vgrow="ALWAYS" style="-fx-padding:  0 0 10 0;">
                        <columns>
                            <TableColumn fx:id="colIntNombre" text="Cliente" prefWidth="250" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colIntLocalidad" text="Localidad" prefWidth="150" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colIntIntereses" text="Sus Intereses" prefWidth="400" style="-fx-alignment: CENTER;"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>

            <Tab text="Pedidos a Editorial">
                <VBox spacing="0">
                    <HBox spacing="15" style="-fx-padding: 30 30 20 30; -fx-alignment: CENTER_LEFT;">
                        <Label text="ConsolidaciÃ³n de Pedidos Pendientes" style="-fx-text-fill: #ffd700; -fx-font-size: 16px; -fx-font-weight: bold;" minWidth="-Infinity"/>
                        <Region HBox.hgrow="ALWAYS" />

                        <Button text="âž• Nuevo Pedido" onAction="#nuevoPedido" style="-fx-background-color: #e67e22; -fx-text-fill: white; -fx-font-weight: bold;"/>

                        <Button text="ðŸ—‘ Borrar Lista" onAction="#borrarPedidos" style="-fx-background-color: #c0392b; -fx-text-fill: white; -fx-font-weight: bold;"/>

                        <Button text="ðŸ”„ Refrescar" onAction="#cargarPedidosPendientes"/>
                        <Button text="ðŸ“„ Generar Lista de Compra (PDF)" onAction="#generarPdfEditorial" styleClass="boton-verde"/>
                    </HBox>

                    <TableView fx:id="tablaEditorial" VBox.vgrow="ALWAYS" style="-fx-padding:  0 0 10 0;">
                        <columns>
                            <TableColumn fx:id="colEdLibro" text="Libro Solicitado" prefWidth="250" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colEdCliente" text="Cliente" prefWidth="180" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colEdFecha" text="Fecha Pedido" prefWidth="120" style="-fx-alignment: CENTER;"/>

                            <TableColumn fx:id="colEdEstado" text="Estado" prefWidth="120" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colEdAccion" text="Actualizar Estado" prefWidth="150" style="-fx-alignment: CENTER;"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>

            <Tab text="Oportunidades (Familia)">
                <VBox spacing="0">
                    <HBox spacing="15" style="-fx-padding: 20; -fx-alignment: CENTER_LEFT;">
                        <Label text="Filtrar por Edad:" style="-fx-text-fill: white;" minWidth="-Infinity"/>

                        <TextField fx:id="txtEdadMin" promptText="MÃ­n (ej: 4)" prefWidth="80"/>
                        <Label text="a" style="-fx-text-fill: white;" minWidth="-Infinity"/>
                        <TextField fx:id="txtEdadMax" promptText="MÃ¡x (ej: 8)" prefWidth="80"/>

                        <Button text="ðŸ” Buscar Oportunidades" onAction="#buscarPorEdadFamilia" styleClass="boton-azul"/>

                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="lblSugerencia" text="Sugerencia: -" style="-fx-text-fill: #ffd700; -fx-font-style: italic;" minWidth="-Infinity"/>
                    </HBox>

                    <TableView fx:id="tablaFamilia" VBox.vgrow="ALWAYS" style="-fx-padding: 0 0 10 0;">
                        <columns>
                            <TableColumn fx:id="colFamCliente" text="Cliente (Comprador)" prefWidth="200" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colFamNombre" text="Familiar" prefWidth="150" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colFamEdad" text="Edad" prefWidth="80" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colFamInteres" text="InterÃ©s EspecÃ­fico" prefWidth="150" style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="colFamSugerencia" text="Libros Sugeridos" prefWidth="250" style="-fx-alignment: CENTER;"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>

        </TabPane>
    </center>
</BorderPane>